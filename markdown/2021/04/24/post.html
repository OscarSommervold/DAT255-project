<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Exploring deep learning and satellite data with the fastai library | fastpages</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Exploring deep learning and satellite data with the fastai library" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="DAT 255 project blog post" />
<meta property="og:description" content="DAT 255 project blog post" />
<link rel="canonical" href="https://oscarsommervold.github.io/DAT255-project/markdown/2021/04/24/post.html" />
<meta property="og:url" content="https://oscarsommervold.github.io/DAT255-project/markdown/2021/04/24/post.html" />
<meta property="og:site_name" content="fastpages" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-04-24T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://oscarsommervold.github.io/DAT255-project/markdown/2021/04/24/post.html","@type":"BlogPosting","headline":"Exploring deep learning and satellite data with the fastai library","dateModified":"2021-04-24T00:00:00-05:00","datePublished":"2021-04-24T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://oscarsommervold.github.io/DAT255-project/markdown/2021/04/24/post.html"},"description":"DAT 255 project blog post","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/DAT255-project/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://oscarsommervold.github.io/DAT255-project/feed.xml" title="fastpages" /><link rel="shortcut icon" type="image/x-icon" href="/DAT255-project/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/DAT255-project/">fastpages</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/DAT255-project/about/">About Me</a><a class="page-link" href="/DAT255-project/search/">Search</a><a class="page-link" href="/DAT255-project/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Exploring deep learning and satellite data with the fastai library</h1><p class="page-description">DAT 255 project blog post</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-04-24T00:00:00-05:00" itemprop="datePublished">
        Apr 24, 2021
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      3 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/DAT255-project/categories/#markdown">markdown</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
</ul><p><strong>Background</strong></p>

<p>Due to government changes and cost reductions, the number of satellite launched into orbit has drastically increased in recent years. <br>
<img src="https://user-images.githubusercontent.com/59794395/115969796-2956a900-a53f-11eb-9245-a895f6bebb62.png" width="600" height="600"><br>
image from https://www.researchgate.net/figure/The-cumulative-number-of-near-polar-orbiting-high-resolution-Earth-observing-civilian_fig2_340004098)</p>

<p>Many of these satellites capture images of the earth’s surface through various ranges of the electromagnetic spectrum. This combined with the recent advancement in deep learning technology such as the <a href="https://arxiv.org/abs/1505.04597">U-Net</a> has lead to rapid growth in the field of geospatial machine learning. Although this is a relatively new field, there are already several large companies such as <a href="https://spaceknow.com/">spaceknow</a> with several established solutions when it comes to extracting insight from data gathered by these satellites 
<img src="https://user-images.githubusercontent.com/59794395/115969813-3bd0e280-a53f-11eb-9cb8-011ff1560b6d.png" width="600" height="600"><br>
 (image from https://courses.lumenlearning.com/astronomy/chapter/the-electromagnetic-spectrum/)</p>

<p><strong>Project</strong></p>

<p>The goal of this project is to explore the possibilities of applying deep learning to satellite data using the fastai library. In the early phases I spent some time looking at the most common use cases. As it turns out those were image classifiers and segmentation models. Equipped with close to zero knowledge, a ton of motivation and a healthy amount of naivety I started to explore SpaceNet’s <a href="https://spacenet.ai/sn7-challenge/">Multi-Temporal Urban Development Challenge</a>. It took me longer than I want to admit to realize that the challenge was way beyond my capabilities before I decided to move on to another challenge. The SpaceNet challenge was a segmentation problem so I decided to start fresh with the <a href="https://www.kaggle.com/c/statoil-iceberg-classifier-challenge">Statoil iceberg classifier challenge</a>. Since this was a kaggle competition from several years ago I had numerous notebooks to look at for guidance.</p>

<p><strong>Iceberg-challenge</strong></p>

<p>Drifting icebergs present threats to navigation, large companies like Statoil use satellite data to monitor thrats such as icebergs. This particular data consist of feedback from a C-band radar with two channels. The radar operates at decibel frequency which can see through all types of weather. From the beckground section: “An object will appear as a bright spot because it reflects more radar energy than its surroundings, but strong echoes can come from anything solid - land, islands, sea ice, as well as icebergs and ships. The energy reflected back to the radar is referred to as backscatter.”. The objective is to use the satellite data to identify if the energy reflected back to the radar is a ship or an iceberg.</p>

<p>The dataset looks like this, where inc_angle is the angle of the satellite. I ended up not using the incidence angle data since almost 10% of it was missing and I just wanted to produce a working model. 
<img src="https://user-images.githubusercontent.com/59794395/115969833-52773980-a53f-11eb-8ecd-1fcbe3fea49f.png" alt="image"></p>

<p>Before I could load the data into fastai I had to deflatten the two bands and construct a third band in order to represent the satellite data as a color composite image.  !<img src="https://user-images.githubusercontent.com/59794395/115969840-602cbf00-a53f-11eb-93eb-0d71eb4f781c.png" alt="image"></p>

<p>Plot of the images created by the function
<img src="https://user-images.githubusercontent.com/59794395/115969850-6cb11780-a53f-11eb-88d0-797f035d1b76.png" alt="image"></p>

<p>All that is left now is to structure the data properly so that it is easy to put into an ImageDataLoader<br>
<img src="https://user-images.githubusercontent.com/59794395/115969862-79357000-a53f-11eb-8ef1-a8aa6b6d1e0f.png" alt="image"></p>

<p>Once the data is put into the DataBlock API it is trivial to create the convolutional nerual network using fastai’s cnn_learner to analyze the images. In the original competition submissions were evaluated on log loss, which is equivalent to fastai’s CrossEntropyLoss. I opted for using Resnet50 and upscaling the 75x75 images to 224x224 resolution since training only took ~10 seconds per epoch. 
<img src="https://user-images.githubusercontent.com/59794395/115969893-99652f00-a53f-11eb-9a83-ae4787870daf.png" alt="image"></p>

<p>The performance of the model was decent considering the quick and dirty approach. <img src="https://user-images.githubusercontent.com/59794395/115969916-a84be180-a53f-11eb-9d1b-d37afe118ac8.png" alt="image"></p>

<p><strong>ForestNet</strong></p>

<p>My next step in the project was to explore the ForestNet dataset along with the <a href="https://arxiv.org/pdf/2011.05479.pdf">paper</a>.  The goal was to create a working segmentation model. My exploration of the <a href="https://stanfordmlgroup.github.io/projects/forestnet/">ForestNet dataset</a> has its own blog post <a href="https://oscarsommervold.github.io/DAT255-project/2021/04/24/forestnet-segmentation.html">here</a></p>

  </div><a class="u-url" href="/DAT255-project/markdown/2021/04/24/post.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/DAT255-project/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/DAT255-project/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/DAT255-project/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" title="fastai"><svg class="svg-icon grey"><use xlink:href="/DAT255-project/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/DAT255-project/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
